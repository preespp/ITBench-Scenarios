---
metadata:
  version: "v1"
fault:
  - entity:
      name: init-container-hang-demo
      group_id: email-pod-1
      kind: Custom
    condition: Init container stuck in sleep loop, preventing pod from starting
    category: Custom
    fault_mechanism: patch
alerts:
  - id: PendingPodsDetected
    group_id: email-pod-1
    metadata:
      description: Emailservice pod stuck in Init phase due to hanging init container
  - id: NoRequestsDetected
    group_id: email-service-1
    metadata:
      description: No incoming requests handled by emailservice because pods are pending
  - id: RequestLatency
    group_id: frontend-service-1
    metadata:
      description: Increased frontend response latency due to unavailable backend (emailservice)
groups:
  - id: email-pod-1
    kind: Pod
    filter:
      - email-.*
    namespace: otel-demo
    root_cause: true
  - id: email-service-1
    kind: Service
    filter:
      - email\b
    namespace: otel-demo
  - id: frontend-pod-1
    kind: Pod
    filter:
      - frontend-.*
    namespace: otel-demo
  - id: frontend-service-1
    kind: Service
    filter:
      - frontend\b
    namespace: otel-demo
aliases:
  - - email-pod-1
    - email-service-1
  - - frontend-pod-1
    - frontend-service-1
propagations:
  - source: email-pod-1
    target: email-service-1
    condition: Init container prevents pod startup
    effect: Emailservice endpoint unavailable
  - source: email-service-1
    target: frontend-service-1
    condition: Frontend unable to call backend emailservice
    effect: Increased frontend latency and 5xx errors
recommended_actions:
  - solution:
      id: remove_hang_patch
      actions:
        - Identify init container stuck in Init phase via `kubectl describe pod`
        - Patch or delete the init container to restore normal startup
        - Redeploy the emailservice deployment to remove hang behavior
